<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working with ParConfigs and ParamSets • mlrHyperopt</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Working with ParConfigs and ParamSets">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mlrHyperopt</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/mlrHyperopt.html">
    <span class="fa fa-bolt"></span>
     
    Introduction
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file-text-o"></span>
     
    Topics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/working_with_parconfigs_and_paramsets.html">Working with ParConfigs and ParamSets</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-book"></span>
     
    Reference
  </a>
</li>
<li>
  <a href="http://mlrhyperopt.jakob-r.de/parconfigs">
    <span class="fa fa-cubes"></span>
     
    ParConfigs
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jakob-r/mlrHyperopt">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Working with ParConfigs and ParamSets</h1>
                        <h4 class="author">Jakob Richter</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jakob-r/mlrHyperopt/blob/master/vignettes/working_with_parconfigs_and_paramsets.Rmd"><code>vignettes/working_with_parconfigs_and_paramsets.Rmd</code></a></small>
      <div class="hidden name"><code>working_with_parconfigs_and_paramsets.Rmd</code></div>

    </div>

    
    
<p>This Vignette is covers the <code>ParConfig</code> objects, what they contain and how they are created.</p>
<div id="components-of-a-parconfig" class="section level2">
<h2 class="hasAnchor">
<a href="#components-of-a-parconfig" class="anchor"></a>Components of a <code>ParConfig</code>
</h2>
<p>First we will create a <code>ParConfig</code> so we can have a look at what we need.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="kw">makeIntegerParam</span>(<span class="st">"k"</span>, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">20</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>pc =<span class="st"> </span><span class="kw"><a href="../reference/makeParConfig.html">makeParConfig</a></span>(</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="dt">learner =</span> <span class="st">"classif.knn"</span>,</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="dt">par.set =</span> ps</span>
<span id="cb1-7"><a href="#cb1-7"></a>)</span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(pc, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## List of 6
##  $ par.set                 :List of 2
##   ..- attr(*, "class")= chr "ParamSet"
##  $ par.vals                : NULL
##  $ associated.learner.class: chr "classif.knn"
##  $ associated.learner.type : chr "classif"
##  $ associated.learner.name : chr "knn"
##  $ note                    : chr ""
##  - attr(*, "class")= chr "ParConfig"</code></pre>
<p>Now we already saw a minimal way to create a <code>ParConfig</code> out of a <code>ParamSet</code> and the according <code>learner</code>. Instead of the string <code>"classif.knn"</code> you can also directly pass the <code>mlr</code> learner object. We see that <code>par.vals</code> and <code>note</code> is not used.</p>
<ul>
<li>
<code>par.vals</code> is to store fixed parameter settings that we want to use to override the defaults of the <code>learner</code>.</li>
<li>
<code>note</code> is just for leaving a comment that will eventually be visible online once you decide to upload your <code>ParConfig</code>.</li>
</ul>
<div id="access-the-components-of-a-parconfig" class="section level3">
<h3 class="hasAnchor">
<a href="#access-the-components-of-a-parconfig" class="anchor"></a>Access the components of a <code>ParConfig</code>
</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="../reference/getParConfigParSet.html">getParConfigParSet</a></span>(pc)</span></code></pre></div>
<pre><code>##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="../reference/getParConfigParVals.html">getParConfigParVals</a></span>(pc)</span></code></pre></div>
<pre><code>## list()</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../reference/getParConfigLearnerClass.html">getParConfigLearnerClass</a></span>(pc)</span></code></pre></div>
<pre><code>## [1] "classif.knn"</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/getParConfigLearnerName.html">getParConfigLearnerName</a></span>(pc)</span></code></pre></div>
<pre><code>## [1] "knn"</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="../reference/getParConfigLearnerType.html">getParConfigLearnerType</a></span>(pc)</span></code></pre></div>
<pre><code>## [1] "classif"</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="../reference/getParConfigNote.html">getParConfigNote</a></span>(pc)</span></code></pre></div>
<pre><code>## [1] ""</code></pre>
</div>
<div id="modify-the-components-of-a-parconfig" class="section level3">
<h3 class="hasAnchor">
<a href="#modify-the-components-of-a-parconfig" class="anchor"></a>Modify the components of a <code>ParConfig</code>
</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>(<span class="dt">pc.reg =</span> <span class="kw"><a href="../reference/setParConfigLearner.html">setParConfigLearner</a></span>(pc, <span class="st">"regr.kknn"</span>))</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: 
##   Associated Learner: regr.kknn
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="../reference/setParConfigLearnerType.html">setParConfigLearnerType</a></span>(pc.reg, <span class="st">"classif"</span>)</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: 
##   Associated Learner: classif.kknn
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="../reference/setParConfigNote.html">setParConfigNote</a></span>(pc.reg, <span class="st">"A note..."</span>)</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: 
##   Associated Learner: regr.kknn
##   Note: A note...
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="../reference/setParConfigParVals.html">setParConfigParVals</a></span>(pc.reg, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">scale =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: scale=FALSE
##   Associated Learner: regr.kknn
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="kw"><a href="../reference/setParConfigParSet.html">setParConfigParSet</a></span>(pc.reg, <span class="kw">makeParamSet</span>(<span class="kw">makeIntegerParam</span>(<span class="st">"k"</span>, <span class="dv">3</span>, <span class="dv">11</span>)))</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: 
##   Associated Learner: regr.kknn
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 3 to 11   -    TRUE     -</code></pre>
</div>
</div>
<div id="create-a-parconfig" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-parconfig" class="anchor"></a>Create a <code>ParConfig</code>
</h2>
<p>We already saw how to minimally create a <code>ParConfig</code> in the first example. Let’s look at more examples:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>lrn =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"regr.kknn"</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw"><a href="../reference/makeParConfig.html">makeParConfig</a></span>(</span>
<span id="cb25-3"><a href="#cb25-3"></a>  <span class="dt">par.set =</span> ps,</span>
<span id="cb25-4"><a href="#cb25-4"></a>  <span class="dt">learner =</span> lrn,</span>
<span id="cb25-5"><a href="#cb25-5"></a>  <span class="dt">par.vals =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">kernel =</span> <span class="st">"gaussian"</span>),</span>
<span id="cb25-6"><a href="#cb25-6"></a>  <span class="dt">note =</span> <span class="st">"This is just an example with the kernel set to 'Gaussian'."</span></span>
<span id="cb25-7"><a href="#cb25-7"></a>)</span></code></pre></div>
<pre><code>## Parameter Configuration
##   Parameter Values: kernel=gaussian
##   Associated Learner: regr.kknn
##   Note: This is just an example with the kernel set to 'Gaussian'.
##   Parameter Set:
##      Type len Def  Constr Req Tunable Trafo
## k integer   -   - 1 to 20   -    TRUE     -</code></pre>
<div id="create-a-parconfig-without-a-specific-learner" class="section level3">
<h3 class="hasAnchor">
<a href="#create-a-parconfig-without-a-specific-learner" class="anchor"></a>Create a <code>ParConfig</code> without a specific learner</h3>
<p><code>mlr</code> differentiates learners pretty strictly from their type (e.g. <em>classification</em>, <em>regression</em>, <em>cluster</em> etc.) although sometimes they share the same <em>R</em> function in the underlying package. If we want to allow the <code>ParConfig</code> to serve for <code>classif.knn</code> as well as <code>regr.knn</code> we have to construct it less strict like the following:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>pc.less =<span class="st"> </span><span class="kw"><a href="../reference/makeParConfig.html">makeParConfig</a></span>(</span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="dt">learner.name =</span> <span class="st">"knn"</span>,</span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="dt">par.set =</span> ps</span>
<span id="cb27-4"><a href="#cb27-4"></a>)</span>
<span id="cb27-5"><a href="#cb27-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(pc.less, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## List of 6
##  $ par.set                 :List of 2
##   ..- attr(*, "class")= chr "ParamSet"
##  $ par.vals                : NULL
##  $ associated.learner.class: NULL
##  $ associated.learner.type : NULL
##  $ associated.learner.name : chr "knn"
##  $ note                    : chr ""
##  - attr(*, "class")= chr "ParConfig"</code></pre>
<p>Or if you are unsure about the learner name but have the <code>mlr</code> learner object:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a>lrn =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"classif.knn"</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a>pc.less =<span class="st"> </span><span class="kw"><a href="../reference/makeParConfig.html">makeParConfig</a></span>(</span>
<span id="cb29-3"><a href="#cb29-3"></a>  <span class="dt">learner.name =</span> <span class="kw"><a href="../reference/getLearnerName.html">getLearnerName</a></span>(lrn),</span>
<span id="cb29-4"><a href="#cb29-4"></a>  <span class="dt">par.set =</span> ps</span>
<span id="cb29-5"><a href="#cb29-5"></a>)</span>
<span id="cb29-6"><a href="#cb29-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(pc.less, <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## List of 6
##  $ par.set                 :List of 2
##   ..- attr(*, "class")= chr "ParamSet"
##  $ par.vals                : NULL
##  $ associated.learner.class: NULL
##  $ associated.learner.type : NULL
##  $ associated.learner.name : chr "knn"
##  $ note                    : chr ""
##  - attr(*, "class")= chr "ParConfig"</code></pre>
<p><em>Note:</em> The function <code>generateParConfig</code> will return a <code>ParConfig</code> for a given learner with a default tuning <code>ParamSet</code>.</p>
</div>
</div>
<div id="the-basics-of-a-paramset" class="section level2">
<h2 class="hasAnchor">
<a href="#the-basics-of-a-paramset" class="anchor"></a>The Basics of a <code>ParamSet</code>
</h2>
<p>Most of the power of a <code>ParConfig</code> lies it in the <code>ParamSet</code> which is part of the <a href="https://github.com/berndbischl/ParamHelpers">ParamHelpers</a> package. The most important features will be explained in the following.</p>
<div id="creating-a-paramset" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-paramset" class="anchor"></a>Creating a <code>ParamSet</code>
</h3>
<p>If we want to create a <code>ParamSet</code> for a specific <code>mlr</code> learner it is always helpful to check which parameters are available.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a>lrn =<span class="st"> </span><span class="kw">makeLearner</span>(<span class="st">"classif.ksvm"</span>)</span>
<span id="cb31-2"><a href="#cb31-2"></a><span class="kw">getParamSet</span>(lrn)</span></code></pre></div>
<pre><code>##                        Type  len    Def
## scaled              logical    -   TRUE
## type               discrete    -  C-svc
## kernel             discrete    - rbfdot
## C                   numeric    -      1
## nu                  numeric    -    0.2
## epsilon             numeric    -    0.1
## sigma               numeric    -      -
## degree              integer    -      3
## scale               numeric    -      1
## offset              numeric    -      1
## order               integer    -      1
## tol                 numeric    -  0.001
## shrinking           logical    -   TRUE
## class.weights numericvector &lt;NA&gt;      -
## fit                 logical    -   TRUE
## cache               integer    -     40
##                                                 Constr Req Tunable Trafo
## scaled                                               -   -    TRUE     -
## type              C-svc,nu-svc,C-bsvc,spoc-svc,kbb-svc   -    TRUE     -
## kernel        vanilladot,polydot,rbfdot,tanhdot,lap...   -    TRUE     -
## C                                             0 to Inf   Y    TRUE     -
## nu                                            0 to Inf   Y    TRUE     -
## epsilon                                    -Inf to Inf   Y    TRUE     -
## sigma                                         0 to Inf   Y    TRUE     -
## degree                                        1 to Inf   Y    TRUE     -
## scale                                         0 to Inf   Y    TRUE     -
## offset                                     -Inf to Inf   Y    TRUE     -
## order                                      -Inf to Inf   Y    TRUE     -
## tol                                           0 to Inf   -    TRUE     -
## shrinking                                            -   -    TRUE     -
## class.weights                                 0 to Inf   -    TRUE     -
## fit                                                  -   -   FALSE     -
## cache                                         1 to Inf   -    TRUE     -</code></pre>
<p>Now we are facing two problems. First, these parameters don’t have finite box constraints and most tuning methods require finite box constraints. Second, there are quite many and tuning works best when only presented the most important tuning parameters. We will build our own <code>ParamSet</code> accordingly. The function <code>makeParamSet</code> will take any parameter and create a ParamSet object, which in our example would then be used to tune the <code>ksvm</code> model. To name the most important ones</p>
<ul>
<li><code>makeNumericParam(id, lower, upper)</code></li>
<li><code>makeIntegerParam(id, lower, upper)</code></li>
<li><code>makeLogicParam(id)</code></li>
<li><code>makeDiscreteParam(id, values)</code></li>
</ul>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a>ps.svm =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb33-2"><a href="#cb33-2"></a>  <span class="kw">makeNumericParam</span>(<span class="st">"C"</span>, <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">100</span>),</span>
<span id="cb33-3"><a href="#cb33-3"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"kernel"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"polydot"</span>,<span class="st">"rbfdot"</span>))</span>
<span id="cb33-4"><a href="#cb33-4"></a>)</span></code></pre></div>
<p><em>Attention!</em> Here we see the first problem: The parameter <em>C</em> is more sensitive to changes for values around zero. We will use the <code>trafo</code> argument of <code>makeNumericParam()</code>so that our search space for <code>C</code> accounts for the sensitivity near zero.</p>
</div>
<div id="creating-a-paramset-with-a-transformation" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-paramset-with-a-transformation" class="anchor"></a>Creating a <code>ParamSet</code> with a transformation</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>ps.svm.trafo =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb34-2"><a href="#cb34-2"></a>  <span class="kw">makeNumericParam</span>(<span class="st">"C"</span>, <span class="dt">lower =</span> <span class="dv">-5</span>, <span class="dt">upper =</span> <span class="dv">7</span>, <span class="dt">trafo =</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="op">^</span>x),</span>
<span id="cb34-3"><a href="#cb34-3"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"kernel"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"polydot"</span>,<span class="st">"rbfdot"</span>))</span>
<span id="cb34-4"><a href="#cb34-4"></a>)</span></code></pre></div>
<p>Let’s compare randomly drawn values:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a>s1 =<span class="st"> </span><span class="kw">sampleValues</span>(ps.svm, <span class="dt">n =</span> <span class="dv">100</span>)</span>
<span id="cb35-2"><a href="#cb35-2"></a>s2 =<span class="st"> </span><span class="kw">sampleValues</span>(ps.svm.trafo, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">trafo =</span> <span class="ot">TRUE</span>)</span>
<span id="cb35-3"><a href="#cb35-3"></a>op =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb35-4"><a href="#cb35-4"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(BBmisc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BBmisc/man/extractSubList.html">extractSubList</a></span>(s1, <span class="st">"C"</span>))</span>
<span id="cb35-5"><a href="#cb35-5"></a><span class="kw"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span>(BBmisc<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BBmisc/man/extractSubList.html">extractSubList</a></span>(s2, <span class="st">"C"</span>))</span></code></pre></div>
<p><img src="working_with_parconfigs_and_paramsets_files/figure-html/ps_trafo_comparison-1.png" width="700"></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(op)</span></code></pre></div>
<p>As transformations can be arbitrary functions they can be used for other useful purposes as only generating uneven numbers, which makes sense for <code>knn</code> classification to not have ties:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>ps.knn =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb37-2"><a href="#cb37-2"></a>  <span class="kw">makeNumericParam</span>(<span class="st">"k"</span>, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">6</span>, <span class="dt">trafo =</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="op">*</span>x<span class="dv">-1</span>)</span>
<span id="cb37-3"><a href="#cb37-3"></a>)</span></code></pre></div>
</div>
<div id="creating-a-paramset-with-dependent-hierarchical-parameters" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-paramset-with-dependent-hierarchical-parameters" class="anchor"></a>Creating a <code>ParamSet</code> with dependent / hierarchical parameters</h3>
<p>For our SVM example we actually would like to tune the parameter <em>sigma</em> for the <code>rbfdot</code> kernel and the <em>degree</em> for the <code>polydot</code> kernel. So the <em>sigma</em> parameter should only be active when <em>kernel</em> is set to <code>rbfdot</code> and <em>degree</em> should only be active for <code>kernel == "polydot"</code>. To model such dependencies or hierarchical structures in the parameter space all <code>make*Param</code> functions have the <code>requires</code> argument which can be used like follows:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>ps.svm.req =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb38-2"><a href="#cb38-2"></a>  <span class="kw">makeNumericParam</span>(<span class="st">"C"</span>, <span class="dt">lower =</span> <span class="dv">-5</span>, <span class="dt">upper =</span> <span class="dv">7</span>, <span class="dt">trafo =</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="op">^</span>x),</span>
<span id="cb38-3"><a href="#cb38-3"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"kernel"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"polydot"</span>,<span class="st">"rbfdot"</span>)),</span>
<span id="cb38-4"><a href="#cb38-4"></a>  <span class="kw">makeNumericParam</span>(<span class="st">"sigma"</span>, <span class="dt">lower =</span> <span class="dv">-5</span>, <span class="dt">upper =</span> <span class="dv">5</span>, <span class="dt">trafo =</span> <span class="cf">function</span>(x) <span class="dv">2</span><span class="op">^</span>x, <span class="dt">requires =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(kernel <span class="op">==</span><span class="st"> "rbfdot"</span>)),</span>
<span id="cb38-5"><a href="#cb38-5"></a>  <span class="kw">makeIntegerParam</span>(<span class="st">"degree"</span>, <span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">5</span>, <span class="dt">requires =</span> <span class="kw"><a href="https://rdrr.io/r/base/substitute.html">quote</a></span>(kernel <span class="op">==</span><span class="st"> "polydot"</span>))</span>
<span id="cb38-6"><a href="#cb38-6"></a>)</span></code></pre></div>
<p>Let’s generate a LHS design to see the effects of the requirements:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">generateDesign</span>(<span class="dv">6</span>, ps.svm.req)</span></code></pre></div>
<pre><code>##            C  kernel     sigma degree
## 1 -1.2177714 polydot        NA      2
## 2  3.3209502  rbfdot -3.411498     NA
## 3  5.6590948 polydot        NA      1
## 4  1.2163571  rbfdot  3.499076     NA
## 5 -0.4340143 polydot        NA      4
## 6 -3.2670645  rbfdot  2.933999     NA</code></pre>
</div>
<div id="creating-a-paramset-with-data-dependent-parameter-spaces" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-a-paramset-with-data-dependent-parameter-spaces" class="anchor"></a>Creating a <code>ParamSet</code> with data dependent parameter spaces</h3>
<p>For some learners the tuning space varies from the data presented. A prominent example is the <em>mtry</em> parameter of the <code>randomForest</code> which determines how many randomly drawn variables are to be considered in every split. The default is <code><a href="https://rdrr.io/r/base/MathFun.html">sqrt(p)</a></code> with <code>p</code> being the number of variables in the data. Naturally we might want to set the boundaries for that value around that default. This is possible using expressions like in the following example:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a>ps.rf =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb41-2"><a href="#cb41-2"></a>  <span class="kw">makeIntegerParam</span>(<span class="st">"mtry"</span>, <span class="dt">lower =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">floor</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(p<span class="op">*</span><span class="fl">0.25</span>))), <span class="dt">upper =</span> <span class="kw"><a href="https://rdrr.io/r/base/expression.html">expression</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(p<span class="op">*</span><span class="fl">0.75</span>))))</span>
<span id="cb41-3"><a href="#cb41-3"></a>)</span></code></pre></div>
<p>Which variables can I use in the expressions?</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="kw"><a href="../reference/getTaskDictionary.html">getTaskDictionary</a></span>(<span class="dt">task =</span> iris.task)</span></code></pre></div>
<pre><code>## $task
## Supervised task: iris-example
## Type: classif
## Target: Species
## Observations: 150
## Features:
##    numerics     factors     ordered functionals 
##           4           0           0           0 
## Missings: FALSE
## Has weights: FALSE
## Has blocking: FALSE
## Has coordinates: FALSE
## Classes: 3
##     setosa versicolor  virginica 
##         50         50         50 
## Positive class: NA
## 
## $p
## [1] 4
## 
## $n.task
## [1] 150
## 
## $type
## [1] "classif"
## 
## $n
## [1] 150
## 
## $k
## [1] 3
## 
## $t
##     setosa versicolor  virginica 
##         50         50         50</code></pre>
<ul>
<li>
<code>p</code> number of features / variables in <em>x</em>
</li>
<li>
<code>n.task</code> number of observations in the task</li>
<li>
<code>type</code> type of the task like <code>classif</code>, <code>regr</code>, <code>cluster</code> and <code>surv</code>.</li>
<li>
<code>n</code> number of observations in the subset</li>
<li>
<code>k</code> number of classes in target</li>
<li>
<code>task</code> the complete task object</li>
</ul>
<p><em>Attention:</em> This feature is not implemented in mlr yet. As a consequence, the expressions have to be pre-evaluated before they can be used for tuning. This also means that <code>n</code> will always be the tasks data set size instead of the number of observations after a cross-validation split. Feature selection will not affect <code>p</code>.</p>
<p>To convert the <code>ParamSet</code> with expressions to a normal <code>ParamSet</code> we call the following:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="kw">evaluateParamExpressions</span>(ps.rf, <span class="dt">dict =</span> <span class="kw"><a href="../reference/getTaskDictionary.html">getTaskDictionary</a></span>(iris.task))</span></code></pre></div>
<pre><code>##         Type len Def Constr Req Tunable Trafo
## mtry integer   -   - 1 to 2   -    TRUE     -</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="kw">evaluateParamExpressions</span>(ps.rf, <span class="dt">dict =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">p =</span> <span class="dv">100</span>, <span class="dt">n =</span> <span class="dv">1000</span>))</span></code></pre></div>
<pre><code>##         Type len Def Constr Req Tunable Trafo
## mtry integer   -   - 5 to 9   -    TRUE     -</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#components-of-a-parconfig">Components of a <code>ParConfig</code></a></li>
      <li><a href="#create-a-parconfig">Create a <code>ParConfig</code></a></li>
      <li><a href="#the-basics-of-a-paramset">The Basics of a <code>ParamSet</code></a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jakob Richter.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
